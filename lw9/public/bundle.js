(()=>{"use strict";var e,t,n={966:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Signal=t.ISignal=void 0;t.ISignal=function(){};var n=function(){function e(){this.m_listeners=[]}return e.prototype.add=function(e){var t=this;return this.m_listeners.push(e),function(){var n=t.m_listeners.indexOf(e);n>=0&&t.m_listeners.splice(n,1)}},e.prototype.addCallOnce=function(e){var t=this.add((function(n){e(n),t()}))},e.prototype.dispatch=function(e){for(var t=0,n=this.m_listeners;t<n.length;t++)(0,n[t])(e)},e.prototype.clearListeners=function(){this.m_listeners=[]},e}();t.Signal=n},435:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TagName=void 0,t.TagName={DIV:"div",BUTTON:"button"}},267:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.download=void 0,t.download=function(e,t){var n=document.createElement("a"),o=new Blob([e],{type:"text/plain"});n.href=URL.createObjectURL(o),n.download=t,n.click(),n.remove()}},81:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateUid=void 0,t.generateUid=function(){for(var e="",t=0;t++<36;){var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx"[t-1],o=16*Math.random()|0;e+="-"==n||"4"==n?n:("x"==n?o:3&o|8).toString(16)}return e}},112:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.uploadFile=void 0,t.uploadFile=function(e){var t=document.createElement("input");t.setAttribute("type","file"),t.click(),t.addEventListener("change",(function(){var n=new FileReader,o=t.files&&t.files[0];o&&(n.onload=function(){"string"==typeof n.result&&e(JSON.parse(n.result))},n.readAsText(o))}))}},509:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasController=void 0;var n=function(){function e(e,t){this.m_model=e,this.m_selectionModel=t}return e.prototype.addShape=function(e){this.m_model.addShape(e)},e.prototype.removeShape=function(e){this.resetSelection(),this.m_model.removeShape(e)},e.prototype.selectShape=function(e){this.m_selectionModel.setSelectedShape(e)},e.prototype.resetSelection=function(){this.m_selectionModel.setSelectedShape(null)},e}();t.CanvasController=n},154:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EditorController=void 0;var o=n(684),r=function(){function e(e,t){this.m_model=e,this.m_selectionModel=t}return e.prototype.addShape=function(e){var t=this.m_model.canvasModel;t.addShape(o.ShapeFactory.createShapeModel({shapeType:e,canvas:t}))},e.prototype.deleteSelectedShape=function(){var e=this.m_model.canvasModel,t=this.m_selectionModel.getSelectedShape();t&&(e.removeShape(t.id),this.m_selectionModel.setSelectedShape(null))},e.prototype.uploadFile=function(){this.m_model.uploadFile()},e.prototype.saveEditor=function(){this.m_model.saveEditor()},e}();t.EditorController=r},440:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionController=void 0;var n=function(){function e(e,t){this.m_model=e,this.m_canvasModel=t}return e.prototype.selectShape=function(e){this.m_model.setSelectedShape(e)},e.prototype.resetSelection=function(){this.m_model.setSelectedShape(null)},e.prototype.resize=function(e){var t=this.m_model.getSelectedShape();if(t){var n=this.m_canvasModel,o=Math.max(e.left,0),r=Math.max(e.top,0),i=Math.min(e.left+e.width,n.getWidth()),a=Math.min(e.top+e.height,n.getHeight());t.setRect(o,r,i-o,a-r)}},e}();t.SelectionController=n},831:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ShapeController=void 0;var n=function(){function e(e,t){this.m_model=e,this.m_canvasModel=t}return e.prototype.shapeMove=function(e){var t=e.left,n=e.top,o=this.m_model.width,r=this.m_model.height;this.m_model.setRect(Math.min(Math.max(t,0),this.m_canvasModel.getWidth()-o),Math.min(Math.max(n,0),this.m_canvasModel.getHeight()-r),o,r)},e}();t.ShapeController=n},684:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ShapeFactory=void 0;var o=n(534),r=n(364),i=n(71),a=n(28),l=function(){function e(){}return e.createShapeModel=function(e){var t=e.shapeType,n=e.canvas,r=e.width,i=void 0===r?100:r,a=e.height,l=void 0===a?70:a,s=e.left,h=void 0===s?n.getWidth()/2-35:s,d=e.top,p=void 0===d?n.getHeight()/2-35:d;return new o.Shape(i,l,p,h,t)},e.createShapeRenderer=function(e,t){switch(e.shapeType){case"rectangle":return new r.RectangleRenderer(e,t);case"ellipse":return new i.EllipseRenderer(e,t);case"triangle":return new a.TriangleRenderer(e,t)}},e}();t.ShapeFactory=l},961:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DragNDropHandler=void 0;var o=n(966),r=function(){function e(e){var t=this;this.onMoveSignal=new o.Signal,this.onShapeMouseDownCallback=function(){},this.onShapeMouseMoveCallback=function(){},this.onShapeMouseUpCallback=function(){},this.m_element=e,this.onShapeMouseDownCallback=function(e){return t.onShapeMouseDown(e)},this.m_element.addEventListener("mousedown",this.onShapeMouseDownCallback)}return e.prototype.getOnMoveSignal=function(){return this.onMoveSignal},e.prototype.onShapeMouseUp=function(){window.removeEventListener("mousemove",this.onShapeMouseMoveCallback),window.removeEventListener("mouseup",this.onShapeMouseUpCallback)},e.prototype.onShapeMove=function(e,t,n){this.onMoveSignal.dispatch({left:e.x-t,top:e.y-n})},e.prototype.onShapeMouseDown=function(e){var t=this;if(!e.defaultPrevented){e.preventDefault();var n=this.m_element.getBoundingClientRect(),o=e.x-n.left,r=e.y-n.top;this.onShapeMouseMoveCallback=function(e){return t.onShapeMove(e,o,r)},this.onShapeMouseUpCallback=function(){return t.onShapeMouseUp()},window.addEventListener("mousemove",this.onShapeMouseMoveCallback),window.addEventListener("mouseup",this.onShapeMouseUpCallback)}},e}();t.DragNDropHandler=r},955:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ResizeHandler=void 0;var o=n(966),r=n(435),i=function(){function e(e){this.onRectChangeSignal=new o.Signal,this.windowMouseMoveHandler=function(){},this.windowMouseUpHandler=function(){},this.m_element=e,this.addResizeHandlers()}return e.prototype.getOnRectChangeSignal=function(){return this.onRectChangeSignal},e.prototype.customizeControllers=function(e,t){e.style.width="".concat(10,"px"),e.style.height="".concat(10,"px"),e.style.position="absolute",e.style.background="blue",e.style.pointerEvents="all";var n="-".concat(5,"px");"leftBottom"===t?(e.style.bottom=n,e.style.left=n):"leftTop"===t?(e.style.top=n,e.style.left=n):"rightBottom"===t?(e.style.bottom=n,e.style.right=n):"rightTop"===t&&(e.style.top=n,e.style.right=n),this.subscribeOnDnd(e,t)},e.prototype.handleMouseUp=function(){window.removeEventListener("mousemove",this.windowMouseMoveHandler),window.removeEventListener("mouseup",this.windowMouseUpHandler)},e.prototype.handlerMouseMove=function(e,t,n){var o=e.clientX,r=e.clientY,i=this.m_element.getBoundingClientRect();if("leftTop"===t){var a=Math.min(o,n.right-20),l=Math.min(r,n.bottom-20);this.onRectChangeSignal.dispatch({left:a,top:l,width:i.right-a,height:i.bottom-l})}else if("rightTop"===t){var s=Math.min(r,n.bottom-20);this.onRectChangeSignal.dispatch({left:i.left,top:s,width:Math.max(o-i.left,20),height:i.bottom-s})}else"leftBottom"===t?(a=Math.min(o,n.right-20),this.onRectChangeSignal.dispatch({left:a,top:i.top,width:i.right-a,height:Math.max(r-i.top,20)})):"rightBottom"===t&&this.onRectChangeSignal.dispatch({left:i.left,top:i.top,width:Math.max(o-i.left,20),height:Math.max(r-i.top,20)})},e.prototype.subscribeOnDnd=function(e,t){var n=this;e.onmousedown=function(e){e.preventDefault();var o=n.m_element.getBoundingClientRect();n.windowMouseMoveHandler=function(e){return n.handlerMouseMove(e,t,{left:o.left,top:o.top,bottom:o.bottom,right:o.right})},n.windowMouseUpHandler=function(){return n.handleMouseUp()},window.addEventListener("mousemove",n.windowMouseMoveHandler),window.addEventListener("mouseup",n.windowMouseUpHandler)}},e.prototype.addResizeHandlers=function(){var e=document.createElement(r.TagName.DIV),t=document.createElement(r.TagName.DIV),n=document.createElement(r.TagName.DIV),o=document.createElement(r.TagName.DIV);this.customizeControllers(e,"leftTop"),this.customizeControllers(t,"rightTop"),this.customizeControllers(n,"leftBottom"),this.customizeControllers(o,"rightBottom"),this.m_element.appendChild(e),this.m_element.appendChild(t),this.m_element.appendChild(n),this.m_element.appendChild(o)},e}();t.ResizeHandler=i},418:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasModel=void 0;var o=n(966),r=function(){function e(e,t,n){void 0===n&&(n=[]),this.m_onShapeCreated=new o.Signal,this.m_onShapeRemoved=new o.Signal,this.m_width=e,this.m_height=t,this.m_shapes=n}return e.prototype.getOnShapeCreated=function(){return this.m_onShapeCreated},e.prototype.getOnShapeRemoved=function(){return this.m_onShapeRemoved},e.prototype.getWidth=function(){return this.m_width},e.prototype.getHeight=function(){return this.m_height},e.prototype.getShapes=function(){return this.m_shapes},e.prototype.addShape=function(e){this.m_shapes.push(e),this.m_onShapeCreated.dispatch(e)},e.prototype.removeShape=function(e){this.m_shapes=this.m_shapes.filter((function(t){return e!==t.id})),this.m_onShapeRemoved.dispatch(e)},e}();t.CanvasModel=r},202:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EditorModel=void 0;var o=n(418),r=n(267),i=n(684),a=n(112),l=n(966),s=n(768),h=function(){function e(){this.m_onUploadState=new l.Signal,this.m_modelSerializer=new s.JSONSerializer,this.m_canvasModel=new o.CanvasModel(640,480)}return Object.defineProperty(e.prototype,"canvasModel",{get:function(){return this.m_canvasModel},enumerable:!1,configurable:!0}),e.prototype.getOnUploadState=function(){return this.m_onUploadState},e.prototype.uploadFile=function(){var e=this;(0,a.uploadFile)((function(t){var n=t;e.m_canvasModel=new o.CanvasModel(n.canvasWidth,n.canvasHeight),n.shapes.forEach((function(t){var n=i.ShapeFactory.createShapeModel({shapeType:t.type,canvas:e.m_canvasModel,top:t.top,left:t.left,width:t.width,height:t.height});e.m_canvasModel.addShape(n)})),e.m_onUploadState.dispatch()}))},e.prototype.saveEditor=function(){(0,r.download)(this.m_modelSerializer.serializeCanvas(this.m_canvasModel),"editor.json")},e}();t.EditorModel=h},566:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionModel=void 0;var o=n(966),r=function(){function e(){this.m_selectedShape=null,this.m_onSelectedShapeChanged=new o.Signal}return e.prototype.onSelectedShapeChanged=function(){return this.m_onSelectedShapeChanged},e.prototype.setSelectedShape=function(e){this.m_selectedShape=e,this.m_onSelectedShapeChanged.dispatch()},e.prototype.getSelectedShape=function(){return this.m_selectedShape},e}();t.SelectionModel=r},534:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=void 0;var o=n(966),r=n(81),i=function(){function e(e,t,n,i,a){this.onRectChange=new o.Signal,this.m_width=e,this.m_height=t,this.m_left=i,this.m_top=n,this.m_shapeType=a,this.m_id=(0,r.generateUid)()}return e.prototype.getOnRectChange=function(){return this.onRectChange},Object.defineProperty(e.prototype,"id",{get:function(){return this.m_id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shapeType",{get:function(){return this.m_shapeType},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.m_width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.m_height},enumerable:!1,configurable:!0}),e.prototype.setRect=function(e,t,n,o){this.m_top=t,this.m_left=e,this.m_width=n,this.m_height=o,this.onRectChange.dispatch()},Object.defineProperty(e.prototype,"left",{get:function(){return this.m_left},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.m_top},enumerable:!1,configurable:!0}),e}();t.Shape=i},768:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.JSONSerializer=t.ISerializer=void 0;t.ISerializer=function(){};var n=function(){function e(){}return e.prototype.serializeCanvas=function(e){var t=this;return JSON.stringify({canvasWidth:e.getWidth(),canvasHeight:e.getHeight(),shapes:e.getShapes().map((function(e){return t.serializeShape(e)}))})},e.prototype.serializeShape=function(e){return JSON.stringify({id:e.id,left:e.left,top:e.top,type:e.shapeType,width:e.width,height:e.height})},e}();t.JSONSerializer=n},438:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonRenderer=void 0;var o=n(694),r=n(435),i=function(){function e(e,t,n){var i=this;this.m_renderer=new o.Renderer(r.TagName.BUTTON),this.m_text=e,n.forEach((function(e){return i.m_renderer.addClassName(e)})),this.m_renderer.setInnerHTML(this.m_text),this.m_renderer.addEventListener("click",(function(e){return t(e)}))}return e.prototype.render=function(e){e.appendChild(this.m_renderer.getDomElement())},e}();t.ButtonRenderer=i},86:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasRenderer=void 0;var o=n(684),r=n(509),i=n(890),a=n(694),l=n(435),s=function(){function e(e,t){var n=this;this.m_renderer=new a.Renderer(l.TagName.DIV),this.m_shapeIdToRendererMap=new Map,this.m_renderer.addClassName("canvas"),this.m_renderer.setStyle("width","".concat(e.getWidth(),"px")),this.m_renderer.setStyle("height","".concat(e.getHeight(),"px")),this.m_model=e,this.m_selectionModel=t,this.m_controller=new r.CanvasController(e,this.m_selectionModel),this.m_selectionView=new i.SelectionView(this.m_selectionModel,this.m_model,this.m_renderer.getDomElement()),this.m_model.getShapes().forEach((function(e){return n.handleShapeCreate(e)})),this.m_model.getOnShapeCreated().add((function(e){return n.handleShapeCreate(e)})),this.m_model.getOnShapeRemoved().add((function(e){return n.handleShapeRemove(e)})),this.m_renderer.addEventListener("mousedown",(function(e){e.defaultPrevented||n.m_controller.resetSelection()})),document.addEventListener("keydown",(function(e){var t=e;n.handleKeydownEvent(t)}))}return e.prototype.clear=function(){var e=this;this.m_model.getShapes().forEach((function(t){e.m_controller.removeShape(t.id)})),this.m_renderer.removeFromDom()},e.prototype.handleDeleteSelectedShape=function(){var e=this.m_selectionModel.getSelectedShape();e&&this.m_controller.removeShape(e.id)},e.prototype.handleKeydownEvent=function(e){"Delete"===e.key&&this.handleDeleteSelectedShape()},e.prototype.handleShapeCreate=function(e){var t=this,n=o.ShapeFactory.createShapeRenderer(e,this.m_model),r=n.getOnSelectSignal().add((function(){return t.m_controller.selectShape(e)}));this.m_shapeIdToRendererMap.set(e.id,{view:n,unsubHandlers:[r]}),n.render(this.m_renderer.getDomElement())},e.prototype.handleShapeRemove=function(e){var t=this.m_shapeIdToRendererMap.get(e);t&&(t.view.removeFromDom(),t.unsubHandlers.forEach((function(e){return e()})),this.m_shapeIdToRendererMap.delete(e))},e.prototype.render=function(e){this.m_renderer.removeFromDom(),e.appendChild(this.m_renderer.getDomElement())},e}();t.CanvasRenderer=s},967:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EditorRenderer=void 0;var o=n(816),r=n(86),i=n(694),a=n(435),l=n(154),s=n(566),h=function(){function e(e){var t=this;this.m_renderer=new i.Renderer(a.TagName.DIV),this.m_workspaceRenderer=new i.Renderer(a.TagName.DIV),this.m_renderer.addClassName("main-container"),this.m_workspaceRenderer.addClassName("workspace"),this.m_model=e;var n=new s.SelectionModel;this.m_controller=new l.EditorController(e,n),this.m_canvasRenderer=new r.CanvasRenderer(e.canvasModel,n),this.m_toolbarRenderer=new o.ToolbarRenderer,this.m_toolbarRenderer.getOnSaveSignal().add((function(){return t.m_controller.saveEditor()})),this.m_toolbarRenderer.getOnUploadSignal().add((function(){return t.m_controller.uploadFile()})),this.m_toolbarRenderer.getOnCreateShapeSignal().add((function(e){return t.m_controller.addShape(e)})),this.m_toolbarRenderer.getOnDeleteShapeSignal().add((function(){return t.m_controller.deleteSelectedShape()})),this.m_model.getOnUploadState().add((function(){return t.updateCanvasRenderer()}))}return e.prototype.updateCanvasRenderer=function(){this.m_canvasRenderer.clear();var e=new s.SelectionModel;this.m_canvasRenderer=new r.CanvasRenderer(this.m_model.canvasModel,e),this.m_canvasRenderer.render(this.m_workspaceRenderer.getDomElement())},e.prototype.render=function(e){this.m_renderer.removeFromDom();var t=this.m_renderer.getDomElement(),n=this.m_workspaceRenderer.getDomElement();e.appendChild(t),this.m_toolbarRenderer.render(t),this.m_renderer.appendChild(n),this.m_canvasRenderer.render(n)},e}();t.EditorRenderer=h},71:function(e,t,n){var o,r=this&&this.__extends||(o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},o(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.EllipseRenderer=void 0;var i=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.m_implElement=document.createElementNS("http://www.w3.org/2000/svg","ellipse"),o}return r(t,e),t.prototype.updateSvgBounds=function(){var e=this.model,t=e.width,n=e.height;this.m_implElement.setAttribute("rx","".concat(t/2)),this.m_implElement.setAttribute("ry","".concat(n/2)),this.m_implElement.setAttribute("cx","".concat(t/2)),this.m_implElement.setAttribute("cy","".concat(n/2)),this.m_implElement.setAttribute("fill","green")},t.prototype.getShapeHtmlImpl=function(){return this.m_implElement},t}(n(654).ShapeRenderer);t.EllipseRenderer=i},364:function(e,t,n){var o,r=this&&this.__extends||(o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},o(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.RectangleRenderer=void 0;var i=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.m_implElement=document.createElementNS("http://www.w3.org/2000/svg","polygon"),o}return r(t,e),t.prototype.updateSvgBounds=function(){var e=this.model,t=e.width,n=e.height;this.m_implElement.setAttribute("points","".concat(0,",").concat(0," ").concat(t,",").concat(0," ").concat(t,",").concat(n," ").concat(0,",").concat(n)),this.m_implElement.setAttribute("fill","black")},t.prototype.getShapeHtmlImpl=function(){return this.m_implElement},t}(n(654).ShapeRenderer);t.RectangleRenderer=i},694:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Renderer=void 0;var n=function(){function e(e){this.m_element=document.createElement(e)}return e.prototype.removeFromDom=function(){this.m_element.remove()},e.prototype.getDomElement=function(){return this.m_element},e.prototype.getBoundingClientRect=function(){return this.m_element.getBoundingClientRect()},e.prototype.addEventListener=function(e,t){this.m_element.addEventListener(e,t)},e.prototype.removeEventListener=function(e,t){this.m_element.removeEventListener(e,t)},e.prototype.addClassName=function(e){this.m_element.classList.add(e)},e.prototype.setInnerHTML=function(e){this.m_element.innerHTML=e},e.prototype.setStyle=function(e,t){this.m_element.style.setProperty(e,t)},e.prototype.appendChild=function(e){this.m_element.appendChild(e)},e}();t.Renderer=n},890:function(e,t,n){var o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionView=void 0;var r=n(955),i=n(694),a=n(435),l=n(440),s=function(){function e(e,t,n){var o=this;this.m_renderer=new i.Renderer(a.TagName.DIV),this.m_onShapeRectChangeUnsub=null,this.m_renderer.addClassName("selection"),this.m_model=e,this.m_controller=new l.SelectionController(e,t),this.m_parentElement=n,this.m_resizeHandler=new r.ResizeHandler(this.m_renderer.getDomElement()),this.m_model.onSelectedShapeChanged().add((function(){return o.handleChangeSelectedShape()}))}return e.prototype.setBoundsByShape=function(e){this.m_renderer.setStyle("width","".concat(e.width,"px")),this.m_renderer.setStyle("height","".concat(e.height,"px")),this.m_renderer.setStyle("left","".concat(e.left,"px")),this.m_renderer.setStyle("top","".concat(e.top,"px"))},e.prototype.handleResetSelection=function(){this.m_renderer.removeFromDom(),this.m_onShapeRectChangeUnsub&&(this.m_onShapeRectChangeUnsub(),this.m_onShapeRectChangeUnsub=null),this.m_resizeHandler.getOnRectChangeSignal().clearListeners()},e.prototype.handleChangeSelectedShape=function(){var e=this;this.handleResetSelection();var t=this.m_model.getSelectedShape();t&&(this.m_onShapeRectChangeUnsub=t.getOnRectChange().add((function(){return e.setBoundsByShape(t)})),this.m_resizeHandler.getOnRectChangeSignal().add((function(t){var n=e.m_parentElement.getBoundingClientRect();e.m_controller.resize(o(o({},t),{left:t.left-n.left,top:t.top-n.top}))})),this.setBoundsByShape(t),this.m_parentElement.appendChild(this.m_renderer.getDomElement()))},e}();t.SelectionView=s},654:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ShapeRenderer=void 0;var o=n(831),r=n(961),i=n(966),a=function(){function e(e,t){var n=this;this.m_svgElement=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.onSelectSignal=new i.Signal,this.m_svgElement.classList.add("shape"),this.m_svgElement.style.setProperty("pointer-events","none"),this.m_svgElement.style.setProperty("pointer-events","none"),this.m_model=e,this.m_controller=new o.ShapeController(e,t),this.m_model.getOnRectChange().add((function(){return n.rerender()}))}return e.prototype.getOnSelectSignal=function(){return this.onSelectSignal},Object.defineProperty(e.prototype,"model",{get:function(){return this.m_model},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controller",{get:function(){return this.m_controller},enumerable:!1,configurable:!0}),e.prototype.removeFromDom=function(){this.m_svgElement.remove()},e.prototype.rerender=function(){var e=this.m_model.left,t=this.m_model.top,n=this.m_model.width,o=this.m_model.height;this.m_svgElement.style.setProperty("left","".concat(e,"px")),this.m_svgElement.style.setProperty("top","".concat(t,"px")),this.m_svgElement.style.setProperty("width","".concat(n,"px")),this.m_svgElement.style.setProperty("height","".concat(o,"px")),this.m_svgElement.setAttribute("viewPort","0 0 ".concat(n," ").concat(o)),this.updateSvgBounds()},e.prototype.render=function(e){var t=this;this.removeFromDom(),this.m_svgElement.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.rerender();var n=this.getShapeHtmlImpl();n.style.setProperty("pointer-events","all"),this.m_svgElement.appendChild(n),new r.DragNDropHandler(n).getOnMoveSignal().add((function(n){var o=e.getBoundingClientRect();t.m_controller.shapeMove({left:n.left-o.left,top:n.top-o.top})})),n.addEventListener("mousedown",(function(e){e.preventDefault(),t.onSelectSignal.dispatch()})),e.appendChild(this.m_svgElement)},e}();t.ShapeRenderer=a},816:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ToolbarRenderer=void 0;var o=n(966),r=n(438),i=n(694),a=n(435),l=function(){function e(){var e=this;this.m_renderer=new i.Renderer(a.TagName.DIV),this.onSaveSignal=new o.Signal,this.onUploadSignal=new o.Signal,this.onCreateShapeSignal=new o.Signal,this.onDeleteShapeSignal=new o.Signal,this.m_renderer.addClassName("toolbar"),this.m_saveButton=new r.ButtonRenderer("Save",(function(){return e.onSaveSignal.dispatch()}),["button"]),this.m_uploadButton=new r.ButtonRenderer("Upload",(function(){return e.onUploadSignal.dispatch()}),["button"]),this.m_createRectangleButton=new r.ButtonRenderer("Rect",(function(){return e.onCreateShapeSignal.dispatch("rectangle")}),["button"]),this.m_createTriangleButton=new r.ButtonRenderer("Triangle",(function(){return e.onCreateShapeSignal.dispatch("triangle")}),["button"]),this.m_createEllipseButton=new r.ButtonRenderer("Ellipse",(function(){return e.onCreateShapeSignal.dispatch("ellipse")}),["button"]),this.m_onDeleteShapeButton=new r.ButtonRenderer("Delete",(function(){return e.onDeleteShapeSignal.dispatch()}),["button"])}return e.prototype.getOnUploadSignal=function(){return this.onUploadSignal},e.prototype.getOnSaveSignal=function(){return this.onSaveSignal},e.prototype.getOnCreateShapeSignal=function(){return this.onCreateShapeSignal},e.prototype.getOnDeleteShapeSignal=function(){return this.onDeleteShapeSignal},e.prototype.render=function(e){var t=this.m_renderer.getDomElement();this.m_saveButton.render(t),this.m_uploadButton.render(t),this.m_createRectangleButton.render(t),this.m_createEllipseButton.render(t),this.m_createTriangleButton.render(t),this.m_onDeleteShapeButton.render(t),e.appendChild(t)},e}();t.ToolbarRenderer=l},28:function(e,t,n){var o,r=this&&this.__extends||(o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},o(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.TriangleRenderer=void 0;var i=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.m_implElement=document.createElementNS("http://www.w3.org/2000/svg","polygon"),o}return r(t,e),t.prototype.updateSvgBounds=function(){var e=this.model,t=e.width,n=e.height;this.m_implElement.setAttribute("points","".concat(0,",").concat(n," ").concat(t,",").concat(n," ").concat(t/2,",").concat(0)),this.m_implElement.setAttribute("fill","yellow")},t.prototype.getShapeHtmlImpl=function(){return this.m_implElement},t}(n(654).ShapeRenderer);t.TriangleRenderer=i}},o={};function r(e){var t=o[e];if(void 0!==t)return t.exports;var i=o[e]={exports:{}};return n[e].call(i.exports,i,i.exports,r),i.exports}e=r(967),t=r(202),window.onload=function(){var n;n=new t.EditorModel,new e.EditorRenderer(n).render(document.body)}})();